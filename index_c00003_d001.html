<!DOCTYPE HTML>
<html>
	<head>
		<title>Understanding the Hive in: Imkerij het schuurtje</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body>
 
		<!-- Header -->
			<header id="header" class="alt">
				<div class="logo"><a href="index_c00003_d001.html"><span>Home</span></a></div>
				<a href="#menu">Menu</a>
			</header>
 
		<!-- Nav -->
			<nav id="menu">
				<ul class="links">
					<li><a href="index_c00003_d001.html">Home</a></li>
					<li><a href="credits.html">Credits</a></li>
				</ul>
			</nav>
 
		<!-- Banner -->
			<section class="banner half">
				<article>
					<img src="images/c00003_d001_1.jpg" alt="" />
					<div class="inner">
						<header>
							<p>In de Imkerij winkel hebben wij een assortiment aan biologische streekproducten.</p>
							<h2>Imkerij het schuurtje</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/c00003_d001_2.jpg" alt="" />
					<div class="inner">
						<header>
							<p>Van kaarsen maken tot interactieve rondleidingen, we bieden het allemaal. Zelfs inclusief versnaperingen of een heuse high tea.</p>
							<h2>Imkerij het schuurtje</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/c00003_d001_3.jpg"  alt="" />
					<div class="inner">
						<header>
							<p>De imkerij is gespecialiseerd in kinderfeestjes.</p>
							<h2>Imkerij het schuurtje</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/c00003_d001_4.jpg"  alt="" />
					<div class="inner">
						<header>
							<p>De imkerij is gespecialiseerd in kinderfeestjes.</p>
							<h2>Imkerij het schuurtje</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/c00003_d001_5.jpg"  alt="" />
					<div class="inner">
						<header>
							<p>Elk jaar exposeren beeldhouders hun beelden in de prachtige cottage tuin van Imkerij ’t Schuurtje</p>
							<h2>Imkerij het schuurtje</h2>
						</header>
					</div>
				</article>
			</section>
 
<!-- One -->
			<section id="one" class="wrapper style3">
				<div class="inner">
					<header class="align-center">
					    <p><strong>Status:</strong> <span id="status">Connecting...</span></p>
					    <input type="text" id="message" placeholder="Ask your question to the beehive!">
					    <button onclick="publishMessage()">Send</button>
					    <h2>Received Messages:</h2>
					    <ul id="messages"></ul>
					</header>
				</div>
			</section>
 
 
<!-- Two -->
			<section id="two" class="wrapper style2">
				<div class="inner">
					<header class="align-center">
 
 
 
						<div>
							<div class="box">
								
								<div class="content">
									<header class="align-center">
										<p>De imkerij is helemaal ingericht om jong en oud op een leuke manier kennis te laten maken met het wonderlijke leven van de honingbij.</p>
									</header>
									<p>{information_text}</p>
									<a href="https://www.imkerij.nl">Visit our homepage</a>
									<footer class="align-center">
										<a href="#" class="button alt">TODO</a>
									</footer>
								</div>
							</div>
						</div>
 
					</div>
				</div>
			</section>
 
 
		<!-- Three -->
			<section id="one" class="wrapper style2">
				<div class="inner">
					<div class="grid-style">
 
						<div>
							<div class="box">
								<div class="image fit">
									<img src="images/c00003_d0011.svg" alt="" />
								</div>
								<div class="content">
									<header class="align-center">
										<p>Het project </p>
										<h2>Beehive Monitoring System Overview</h2>
									</header>
									<p>Ever wondered what’s happening inside a beehive? Our smart monitoring system tracks hive conditions in real-time. Built into a weatherproof box, it connects to WiFi, updates automatically, and runs on solar power with a backup battery.  It measures temperature, humidity, air pressure, light, and even hive sounds. Using advanced analysis, it estimates height, detects sound intensity, and tracks frequency changes. The 'Spaarkast' version includes extra insulation and a durable protective coating.  This system provides valuable insights into hive health, helping beekeepers monitor their colonies more efficiently.</p>
									<footer class="align-center">
										<a href="#" class="button alt">TODO</a>
									</footer>
								</div>
							</div>
						</div>
 
						<div>
							<div class="box">
								<div class="image fit">
									<img src="images/c00003_d0012.svg" alt="" />
								</div>
								<div class="content">
									<header class="align-center">
										<p>Data</p>
										<h2>Temperature (against other hive's)</h2>
									</header>
									<p>Bees carefully manage hive temperature, especially in winter. Instead of heating the whole hive, they keep their cluster warm, reaching about 35°C at the center. Heat naturally rises, so the area above the cluster stays warmer, making top insulation useful for reducing heat loss.  A common myth is that leaving a honey super makes heating harder for bees. In reality, it acts as insulation, helping stabilize temperatures. Plus, honey near the cluster stays warm enough to eat, ensuring bees have easy access to food throughout winter.</p>
									<footer class="align-center">
										<a href="#" class="button alt">TODO</a>
									</footer>
								</div>
							</div>
						</div>
 
					</div>
				</div>
			</section>
 
		<!-- Four -->
			<section id="four" class="wrapper style3">
				<div class="inner">
					<header class="align-center">
						<p>Extra informatie</p>
						<h2>Bekijk alle gegevens (afgezet tegen andere bijenkasten)</h2>
					</header>
				</div>
			</section>
 
		<!-- Five -->
			<section id="five" class="wrapper style2">
				<div class="inner">
					<header class="align-center">
						<p class="special">(relatieve) luchtvochtigheid, licht, (relatieve) luchtdruk en Temperatuur verschil binnen en buiten de kast</p>
						<h2>Alle grafieken</h2>
					</header>
					<div class="gallery">
						<div>
							<div class="image fit">
								<a href="#"><img src="images/c00003_d0013.svg" alt="" /></a>
							</div>
						</div>
						<div>
							<div class="image fit">
								<a href="#"><img src="images/c00003_d0014.svg" alt="" /></a>
							</div>
						</div>
						<div>
							<div class="image fit">
								<a href="#"><img src="images/c00003_d0015.svg" alt="" /></a>
							</div>
						</div>
						<div>
							<div class="image fit">
								<a href="#"><img src="images/c00003_d0016.svg" alt="" /></a>
							</div>
						</div>
					</div>
				</div>
			</section>
 
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
		<script>
		        const broker = "wss://k9931f8c.ala.eu-central-1.emqxsl.com:8084/mqtt";
		        const clientId = "mqtt_test_client_" + Math.random().toString(16).substr(2, 8);
		        const options = {
		            clientId: clientId,
		            clean: true,
		            connectTimeout: 4000,
		            username: "qr_code_user", // Add your EMQX username
				    password: "qr_code_password", // Add your EMQX password
					cleanSession: true,
		        };
 
				// create timer constants
				let connectionTime;
				let messageTime;
				let waitingTime;
				let startTime;
				let waitingInterval;
		
		        const client = mqtt.connect(broker, options);
		
		        client.on("connect", () => {
					// record timestamp of making the connection
					connectionTime = new Date().getTime();
					console.log(`Connection Time is: ${connectionTime}`);
 
		            document.getElementById("status").textContent = "Connected to the hive!";
		            console.log("Connected to MQTT Broker");
		            client.subscribe("v000/c00003/d001/answer", (err) => {
		                if (err) console.error("Subscribe error:", err);
		            });
		        });
 
				client.on("message", (topic, message) => {
					// find the message timestamp
					messageTime = new Date().getTime();
					console.log(`Message Time is: ${messageTime}`);
 
					// only display message when it is not from a previous interaction
					if ((messageTime - connectionTime) < 2000 ) {
						console.log('Message is from a previous interaction. Ignore!');
						return;
					}
 
					// display the message
		            console.log(`Received message on topic ${topic}: ${message.toString()}`);
		            displayMessage(`${message.toString()}`);
		        });
 
		        function publishMessage() {
		            const userInput = document.getElementById("message").value;
		            const jsonPayload = {
		                category: "question",
		                cat_value: userInput
		            };
		            const jsonString = JSON.stringify(jsonPayload);
		            console.log("Sending:", jsonString);
		            client.publish("v000/c00003/d001/user", jsonString, (err) => {
		                if (err) console.error("Publish error:", err);
		            });
		
					// Start waiting time
					startTime = new Date().getTime();
					waitingInterval = setInterval(updateWaitingTime, 1000);
	
					// Show message that the question has been sent
					document.getElementById('llmStatus').innerHTML = 'Question sent! Processing reply...';
						
					//disable the button
					document.getElementById("theButton").setAttribute('disabled','disabled');
				}
 
 
		        function displayMessage(msg) {
 
					// clear timer interval, because answer has arrived
					clearInterval(waitingInterval);
					
					//enable the button again
					document.getElementById("theButton").removeAttribute('disabled');
 
					//update status and waiting timer
					document.getElementById('llmStatus').innerHTML = 'Answer received! You can now ask follow-up questions.';
					document.getElementById('waitingTime').innerHTML = `Answer given in ${waitingTime} seconds`;
 
		            const msgList = document.getElementById("messages");
		            const newItem = document.createElement("li");
		            newItem.textContent = msg;
		            msgList.appendChild(newItem);
		        }
 
				function updateWaitingTime() {
					const currentTime = new Date().getTime();
					waitingTime = Math.floor((currentTime - startTime) / 1000);
					document.getElementById('waitingTime').innerHTML = `Processing Time: ${waitingTime} seconds`;
				}
 
		    </script>
 
 
	</body>
</html>
